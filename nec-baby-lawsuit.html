<script src="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/alertify.min.js"></script>
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/alertify.min.css" />
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/default.min.css" />

<style id="custom-css-hk">
    .alertify-notifier.ajs-bottom {
        bottom: 100px !important;
    }

    * {
        font-family: 'Poppins', sans-serif;
    }

    .custom-form {
        border-radius: 1rem;
        font-family: Arial, Helvetica, sans-serif;
    }

    .custom-form .main-header {
        background-color: #0c71c3;
        color: white;
        padding: 2rem;
    }

    .custom-form .main-header * {
        color: white;
    }


    .custom-form .form-grid {
        /* display: grid; */
        width: fit-content;
        /* margin-top: 30px;     */

    }

    @media only screen and (min-width: 600px) {

        .custom-form .form-grid {

            padding: 2rem;

        }

    }

    .custom-form .form-grid label {
        margin: auto 0;
        font-weight: 400;
        display: block;
        margin-top: 10px;
        font-size: 0.9rem;
        margin-bottom: 7px;
        color: black;
    }

    .custom-form .form-grid input {
        font-size: 1rem;
        padding: 9px 17px;
        border-radius: 5px;
        outline: 0;
        color: black;
        border: 1px solid #636363;
        width: 100%;
    }

    input[type=radio] {
        width: fit-content !important;
    }


    input[type=checkbox] {
        width: fit-content !important;
    }


    .custom-form .form-grid h1 {
        margin: 0;
        font-size: 1rem;
        color: white;
        padding: 3px 10px;
        background-color: #0c71c3;

    }

    .custom-form .form-grid h1:hover {
        cursor: pointer;

        background-color: #cccccc;
    }

    #custom-form-submit {

        margin-top: 20px;
        padding: 10px 20px;
        border-radius: 5px;
        font-weight: 600;
        background-color: #0c71c3;
        color: white;
        border: none;
        box-shadow: 2px 2px black;
        /* border: 2px solid black; */
        transition: 0.2s;
        font-size: 1rem;
    }

    #custom-form-submit:hover {
        /* transform: translateY(-1px); */
        box-shadow: none;

    }


    .custom-form .small {
        font-size: 0.7rem;
        font-weight: 600;
    }


    #send_otp_button {
        background-color: #0c71c3;
        border: none;
        color: white;
        border-radius: 0px;
        padding: 10px 20px;
        transition: 0.2s;
        border-radius: 5px;
        font-size: 1rem;
    }

    #send_otp_button:hover {
        background-color: #0e8ef7;
        /* scale: 1.02; */
    }

    #send_otp_button:disabled {
        background-color: #084272;

    }

    #send_otp_button:disabled:hover {
        background-color: #0c71c3;

    }

    #thankyou-view {
        /* display: block; */
        display: none;
        border: 3px solid #0e8ef7;
    }

    #form-view {
        /* display: none; */
        display: block;

    }
</style>




<!-- TrustedForm -->
<script type="text/javascript">
    (function () {
        var tf = document.createElement('script');
        tf.type = 'text/javascript'; tf.async = true;
        tf.src = ("https:" == document.location.protocol ? 'https' : 'http') + "://api.trustedform.com/trustedform.js?field=xxTrustedFormCertUrl&ping_field=xxTrustedFormPingUrl&l=" + new Date().getTime() + Math.random();
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(tf, s);
    })();
</script>
<noscript>
    <img src="https://api.trustedform.com/ns.gif" />
</noscript>
<!-- End TrustedForm -->


<!-- Start of HubSpot Embed Code -->
<script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/42660938.js"></script>
<!-- End of HubSpot Embed Code -->



<body>
    <div class="custom-form">
        <div class="thankyou-switcher">

            <div id="form-view" class="form-view">
                <!-- <div class="main-header">
                    <h1>Get the Justice You Deserve
                    </h1>
                    <h5>Complete the form below to find out if you qualify for compensation.</h5>
                </div> -->
                <form onsubmit="return false;" id="contactForm-custom">
                    <div class="form-grid">
                        <label for="name">Name (Alphabets only):</label>
                        <input type="text" id="name" name="firstname" pattern="[A-Za-z ]+" required>
                        <br />
                        <label for="email">Email:</label>
                        <input type="email" id="email" name="email" required>
                        <br />

                        <label for="phone">Phone (xxx-xxx-xxxx or xxxxxxxxxx):</label>
                        <div>
                            <div onclick="document.getElementById('phone').focus()"
                                style="display:flex;border:1px solid #636363; width: 100%;border-radius: 5px;height: fit-content;">
                                <p style="margin:auto 0;padding:0.5rem;font-size: 0.8rem;color:black;">+1</p>
                                <input style="border:none;" type="number" id="phone" name="phone"
                                    pattern="(\+?1[-.\s]?)?\(?[2-9]\d{2}\)?[-.\s]?\d{3}[-.\s]?\d{4}" required>
                            </div>

                        </div>
                        <div>
                            <label>Click this link</label>
                        </div>
                        <div>
                            <input type="radio" id="occupation-yes" name="click_this_link_" value="yes" required>
                            <label style="display: inline-flex;margin-top: 0;" for="occupation-yes">Yes</label>
                            <input type="radio" id="occupation-no" name="click_this_link_" value="no" required>
                            <label style="display: inline-flex;margin-top: 0;" for="occupation-no">No</label>
                        </div>

                        <button id="custom-form-submit" type="submit">Submit</button>


                    </div>

                </form>
            </div>
            <div id="thankyou-view" class="thankyou-view">
                <h1 style="text-align: center;">Form has been submitted, Thank You for showing interest ! </h1>
            </div>
        </div>
    </div>

</body>

<script>

    const serverURL = 'https://roundup-lawsuit.onrender.com'
    // const serverURL = 'http://192.168.0.107:6969'

    const customForm = document.getElementById('contactForm-custom')

    customForm.addEventListener('submit', () => {
        submitData()
    })

    async function submitData() {

        const sendURL = serverURL + '/new-test-submission'

        const formData = prepareHSFormSubmission(customForm);

        const jsonData = {
            number: document.getElementById('phone').value,
            formData: formData

        };

        try {
            const response = await fetch(sendURL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(jsonData)
            });
            const data = await response.json();

            if (!data.ok) {
                console.log(`HTTP error! Status: ${data.message}`);
            }

            console.log('Server response:', data.message);

            if (data.message == 'OK') {
                alertify.success('Form Submitted');
                setTimeout(() => {
                    window.location.replace('https://publicjusticeadvocates.com/thank-you-page/')
                }, 1000)

            } else {
                alertify.error(data.message);

            }

        } catch (error) {
            console.error('Error:', error);
        }
    }





    function getCookie(name) {
        var value = "; " + document.cookie;
        var parts = value.split("; " + name + "=");
        if (parts.length == 2) {
            return parts.pop().split(";").shift();
        }
    };

    function buildHSContext() {
        let hsContext = new Object()
        hsContext.hutk = getCookie('hubspotutk');
        console.log(getCookie('hutk'))
        hsContext.pageUri = window.location.href;
        hsContext.pageName = document.title;
        return hsContext
    }
    function formFieldsToHSJSON(form) {
        let fieldArray = [];
        let formData = new FormData(form);
        for (let field of formData) {
            if (field[0] == 'otp') continue;
            let values = {
                "name": field[0],
                "value": field[1]
            }
            fieldArray.push(values)
        }
        return fieldArray;
    }

    function prepareHSFormSubmission(form) {
        var submissionData = new Object()
        submissionData.submittedAt = Date.now()
        submissionData.fields = formFieldsToHSJSON(form)
        submissionData.context = buildHSContext()
        console.log(submissionData)
        return submissionData
    }


</script>